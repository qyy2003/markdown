# [2018 Multi-University Training Contest 1](http://acm.hdu.edu.cn/search.php?field=problem&key=2018+Multi-University+Training+Contest+1&source=1&searchmode=source)

## 解题报告

### QYY





### Maximum Multiple
Time Limit: 4000/2000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others)
Total Submission(s): 3731    Accepted Submission(s): 1523

Problem Description
Given an integer n, Chiaki would like to find three positive integers x, y and z such that: n=x+y+z, x∣n, y∣n, z∣n and xyz is maximum.


Input
There are multiple test cases. The first line of input contains an integer T (1≤T≤106), indicating the number of test cases. For each test case:
The first line contains an integer n (1≤n≤106).


Output
For each test case, output an integer denoting the maximum xyz. If there no such integers, output −1 instead.


Sample Input

3
1
2
3

 

Sample Output

-1
-1
1


### Balanced Sequence
Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others)
Total Submission(s): 6531    Accepted Submission(s): 1718


Problem Description
Chiaki has n strings s1,s2,…,sn consisting of '(' and ')'. A string of this type is said to be balanced:

+ if it is the empty string
+ if A and B are balanced, AB is balanced,
+ if A is balanced, (A) is balanced.

Chiaki can reorder the strings and then concatenate them get a new string t. Let f(t) be the length of the longest balanced subsequence (not necessary continuous) of t. Chiaki would like to know the maximum value of f(t) for all possible t.


Input
There are multiple test cases. The first line of input contains an integer T, indicating the number of test cases. For each test case:
The first line contains an integer n (1≤n≤105) -- the number of strings.
Each of the next n lines contains a string si (1≤|si|≤105) consisting of `(' and `)'.
It is guaranteed that the sum of all |si| does not exceeds 5×106.


Output
For each test case, output an integer denoting the answer.


Sample Input

2
1
)()(()(
2
)
)(

 

Sample Output

4
2


 ### Triangle Partition
Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 132768/132768 K (Java/Others)
Total Submission(s): 2698    Accepted Submission(s): 1363
Special Judge

Problem Description
Chiaki has 3n points p1,p2,…,p3n. It is guaranteed that no three points are collinear.
Chiaki would like to construct n disjoint triangles where each vertex comes from the 3n points.


Input
There are multiple test cases. The first line of input contains an integer T, indicating the number of test cases. For each test case:
The first line contains an integer n (1≤n≤1000) -- the number of triangle to construct.
Each of the next 3n lines contains two integers xi and yi (−109≤xi,yi≤109).
It is guaranteed that the sum of all n does not exceed 10000.


Output
For each test case, output n lines contain three integers ai,bi,ci (1≤ai,bi,ci≤3n) each denoting the indices of points the i-th triangle use. If there are multiple solutions, you can output any of them.


Sample Input

1
1
1 2
2 3
3 5

 

Sample Output

1 2 3


 ### Distinct Values
Time Limit: 4000/2000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others)
Total Submission(s): 5115    Accepted Submission(s): 1759


Problem Description
Chiaki has an array of n positive integers. You are told some facts about the array: for every two elements ai and aj in the subarray al..r (l≤i<j≤r), ai≠aj holds.
Chiaki would like to find a lexicographically minimal array which meets the facts.


Input
There are multiple test cases. The first line of input contains an integer T, indicating the number of test cases. For each test case:

The first line contains two integers n and m (1≤n,m≤105) -- the length of the array and the number of facts. Each of the next m lines contains two integers li and ri (1≤li≤ri≤n).

It is guaranteed that neither the sum of all n nor the sum of all m exceeds 106.


Output
For each test case, output n integers denoting the lexicographically minimal array. Integers should be separated by a single space, and no extra spaces are allowed at the end of lines.


Sample Input

3
2 1
1 2
4 2
1 2
3 4
5 2
1 3
2 4

 

Sample Output

1 2
1 2 1 2
1 2 3 1 1


### Maximum Weighted Matching
Time Limit: 8000/4000 MS (Java/Others)    Memory Limit: 65535/65535 K (Java/Others)
Total Submission(s): 181    Accepted Submission(s): 35


Problem Description
Chiaki is good at generating special graphs. Initially, she has a graph with only two vertices connected by an edge. Each time, she can choose an edge (u,v), make a copy of it, insert some new vertices (maybe zero) in the edge (i.e. let the new vertices be t1,t2,…,tk, Chiaki would insert edges (u,t1), (t1,t2), (tk−1,tk), (tk,v) into the graph).
Given a weighted graph generated by above operations, Chiaki would like to know the maximum weighted matching of the graph and the number different maximum weighted matchings modulo (109+7)).
A matching in a graph is a set of pairwise non-adjacent edges, none of which are loops; that is, no two edges share a common vertex.
A maximum weighted matching is defined as a matching where the sum of the values of the edges in the matching have a maximal value.


Input
There are multiple test cases. The first line of input contains an integer T, indicating the number of test cases. For each test case:
The first line contains two integers n and m (1≤n,m≤105) -- the number of vertices and the number of edges.
Each of the next m lines contains three integers ui, vi and wi (1≤ui,vi≤n,1≤wi≤109) -- deonting an edge between ui and vi with weight wi.
It is guaranteed that neither the sum of all n nor the sum of all m exceeds 106.


Output
For each test case, output two integers separated by a single space. The first one is the sum of weight and the second one is the number of different maximum weighted matchings modulo (109+7).


Sample Input

2
6 7
1 2 1
2 3 1
4 5 1
5 6 1
1 4 1
2 5 1
3 6 1
4 5
1 2 1
1 3 1
1 4 1
2 3 1
3 4 1

 

Sample Output

3 3
2 2


### Period Sequence
Time Limit: 12000/6000 MS (Java/Others)    Memory Limit: 65535/65535 K (Java/Others)
Total Submission(s): 156    Accepted Submission(s): 56


Problem Description
Chiaki has n integers s0,s1,…,sn−1. She has defined an infinite sequence S in the following way: Sk=skmodn+n⋅⌊kn⌋, where k is a zero based index.

For a continuous subsequence S[l..r], let cntx be the number of occurrence of x in the subsequence S[l..r]. Then the value of S[l..r] is defined as follows
f(l,r)=∑xx⋅cnt2x


For two integers a and b (a≤b), Chiaki would like to find the value of
(∑a≤l≤r≤bf(l,r))mod(109+7)

 

Input
There are multiple test cases. The first line of input contains an integer T, indicating the number of test cases. For each test case:
The first line contains three integers n, a and b (1≤n≤2000,0≤a≤b≤1018).
The second line contains n integers s0,s1,…,sn−1 (0≤si≤109).
It is guaranteed that the sum of all n does not exceed 20000.


Output
For each test case, output an integer denoting the answer.


Sample Input

4
3 2 6
2 1 3
5 2 7
2 1 5 1 2
4 4 8
2 1 5 17
3 5 9
2 5 2

 

Sample Output

179
268
369
437


### Chiaki Sequence Revisited
Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others)
Total Submission(s): 3232    Accepted Submission(s): 958

Problem Description
Chiaki is interested in an infinite sequence a1,a2,a3,..., which is defined as follows:

$an={1an−an−1+an−1−an−2n=1,2n≥3}$

Chiaki would like to know the sum of the first n terms of the sequence, i.e. ∑i=1nai. As this number may be very large, Chiaki is only interested in its remainder modulo (109+7).

Input
There are multiple test cases. The first line of input contains an integer T (1≤T≤105), indicating the number of test cases. For each test case:
The first line contains an integer n (1≤n≤1018).


Output
For each test case, output an integer denoting the answer.


Sample Input

10
1
2
3
4
5
6
7
8
9
10

 

Sample Output

1
2
4
6
9
13
17
21
26
32


### RMQ Similar Sequence
Time Limit: 4000/2000 MS (Java/Others)    Memory Limit: 255535/255535 K (Java/Others)
Total Submission(s): 1624    Accepted Submission(s): 565


Problem Description
Chiaki has a sequence A={a1,a2,…,an}. Let RMQ(A,l,r) be the minimum i (l≤i≤r) such that ai is the maximum value in al,al+1,…,ar.

Two sequences A and B are called \textit{RMQ Similar}, if they have the same length n and for every 1≤l≤r≤n, RMQ(A,l,r)=RMQ(B,l,r).

For a given the sequence A={a1,a2,…,an}, define the weight of a sequence B={b1,b2,…,bn} be ∑i=1nbi (i.e. the sum of all elements in B) if sequence B and sequence A are RMQ Similar, or 0 otherwise. If each element of B is a real number chosen independently and uniformly at random between 0 and 1, find the expected weight of B.


Input
There are multiple test cases. The first line of input contains an integer T, indicating the number of test cases. For each test case:
The first line contains an integer n (1≤n≤106) -- the length of the sequence.
The second line contains n integers a1,a2,…,an (1≤ai≤n) denoting the sequence.
It is guaranteed that the sum of all n does not exceed 3×106.


Output
For each test case, output the answer as a value of a rational number modulo 109+7.
Formally, it is guaranteed that under given constraints the probability is always a rational number pq (p and q are integer and coprime, q is positive), such that q is not divisible by 109+7. Output such integer a between 0 and 109+6 that p−aq is divisible by 109+7.


Sample Input

3
3
1 2 3
3
1 2 1
5
1 2 3 2 1

 

Sample Output

250000002
500000004
125000001


### Lyndon Substring
Time Limit: 6000/3000 MS (Java/Others)    Memory Limit: 65535/65535 K (Java/Others)
Total Submission(s): 182    Accepted Submission(s): 17


Problem Description
A string w is said to be a Lyndon word if w is lexicographically smaller than any of its cyclic rotations.
The longest Lyndon substring of a string s is the longest substring of s which is a Lyndon word.
Chiaki has n strings s1,s2,…,sn. She has some queries: for some pair (i,j), find the length of the longest Lyndon substring of string sisj.


Input
There are multiple test cases. The first line of input contains an integer T, indicating the number of test cases. For each test case:
The first line contains two integers n and m (1≤n,m≤105) -- the number of strings and the number of queries.
Each of the next n lines contains a nonempty string si (1≤si≤105) consisting of lowercase English letters.
Each of the next m lines contains two integers i and j (1≤i,j≤n) denoting a query.
It is guaranteed that in one test case the sum of all |s| does not exceed 5×105 and that in all cases the sum of all |s| does not exceed 5×106.
It is guaranteed that neither the sum of all n nor the sum of all m exceeds 106.


Output
For each query, output an integer denoting the answer.


Sample Input

1
2 1
aa
bb
1 2

 

Sample Output

4


### Turn Off The Light
Time Limit: 4000/2000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others)
Total Submission(s): 191    Accepted Submission(s): 67


Problem Description
There are n lights aligned in a row. These lights are numbered 1 to n from left to right. Initially some of the lights are turned on. Chiaki would like to turn off all the lights.
Chiaki starts from the p-th light. Each time she can go left or right (i.e. if Chiaki is at x, then she can go to x−1 or x+1) and then press the switch of the light in that position (i.e. if the light is turned on before, it will be turned off and vise versa).
For each p=1,2,…,n, Chiaki would like to know the minimum steps needed to turn off all the lights.


Input
There are multiple test cases. The first line of input is an integer T indicates the number of test cases. For each test case:
The first line contains an integer n (2≤n≤106) -- the number of lights.
The second line contains a binary string s where si=1 means the i-th light is turned on and si=0 means i-th light is turned off.
It is guaranteed that the sum of all n does not exceed 107.


Output
For each test cases, output (∑i=1|s|i×zi)mod(109+7), where zi is the number of step needed when Chikai starts at the i-th light.


Sample Input

3
3
000
3
111
8
01010101

 

Sample Output

0
26
432


 ### Time Zone
Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others)
Total Submission(s): 4615    Accepted Submission(s): 1348


Problem Description
Chiaki often participates in international competitive programming contests. The time zone becomes a big problem.
Given a time in Beijing time (UTC +8), Chiaki would like to know the time in another time zone s.


Input
There are multiple test cases. The first line of input contains an integer T (1≤T≤106), indicating the number of test cases. For each test case:
The first line contains two integers a, b (0≤a≤23,0≤b≤59) and a string s in the format of "UTC+X'', "UTC-X'', "UTC+X.Y'', or "UTC-X.Y'' (0≤X,X.Y≤14,0≤Y≤9).


Output
For each test, output the time in the format of hh:mm (24-hour clock).


Sample Input

3
11 11 UTC+8
11 12 UTC+9
11 23 UTC+0

 

Sample Output

11:11
12:12
03:23

